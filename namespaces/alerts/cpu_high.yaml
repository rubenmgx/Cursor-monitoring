groups:
- name: namespaces.cpu
  rules:
  - alert: NamespaceCPUHigh
    expr: 100 * (sum by (namespace) (node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate)
      / sum by (namespace) (cluster:namespace:pod_cpu:active:kube_pod_container_resource_limits{resource="cpu"})) > 90
    for: 15m
    labels:
      severity: warning
    annotations:
      summary: Namespace CPU above 90% of limits
      description: {{ $labels.namespace }} CPU utilization exceeds 90% of limits
      sop: NAMESPACE_CPU_HIGH.md
